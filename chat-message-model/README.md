## 개요

이 저장소는 대화형 시스템(Chat-based system)을 위한
데이터 모델링 구조와 그에 따른 핵심 설계 원칙을 정리한 문서이다.

본 설계는 다음을 목표로 한다.

- 문서 지향 데이터베이스(MongoDB)에 적합한 모델링
- 대화 맥락과 과거 기록의 보존
- 안정성과 재현 가능성 중심의 구조
- 불필요한 복잡성 최소화

## 핵심 개념

Conversation

- 하나의 대화 세션을 나타내는 단위
- 채팅방
- 여러 개의 Message를 포함하는 aggregate root
- 메시지의 생명주기와 소유권을 관리

Message

- Conversation 내부에 포함되어있는 개별 단위
- Conversation 없이 독립적으로 존재하지 않음

## 주요 설계 요약

1. Message Embedded 구조

- Message는 별도 컬렉션이 아닌 Conversation 내부에 저장
- 대화 단위 조회 성능과 데이터 지역성(Locality)을 우선

2. Snapshot 기반 데이터 저장

- 변경 가능하거나 외부에서 관리되는 정보는 참조 대신 스냅샷으로 저장
- 과거 기록의 정합성과 안정성 확보

3. 식별자(ID) 소유권 분리

- 내부 식별자는 내부 시스템이 소유
- 외부 시스템 ID는 메타데이터로만 사용

4. 설정 불변 저장

- 대화 생성 시 사용된 설정들을 스냅샷으로 보존
- 이후 설정 데이터 변경과 무관하게 과거 대화 맥락 유지

5. 조회 패턴 기반 인덱싱

- 실제 사용되는 쿼리 패턴을 기준으로 인덱스 설계
- 중복되거나 불필요한 인덱스는 제거

## 문서 구조

```
README.md          # 전체 구조 및 설계 요약
architecture.md    # 상세 설계 배경 및 원칙
```
